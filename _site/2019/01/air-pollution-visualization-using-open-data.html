<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Air Pollution Visualization using Open Data - Vijay Pathak</title>
<meta name="description" content="Visualize the air pollution in your community using JavaScript and open-data ">


  <meta name="author" content="Vijay Pathak">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Vijay Pathak">
<meta property="og:title" content="Air Pollution Visualization using Open Data">
<meta property="og:url" content="http://localhost:4000/2019/01/air-pollution-visualization-using-open-data.html">


  <meta property="og:description" content="Visualize the air pollution in your community using JavaScript and open-data ">







  <meta property="article:published_time" content="2019-01-27T00:00:00+05:45">





  

  


<link rel="canonical" href="http://localhost:4000/2019/01/air-pollution-visualization-using-open-data.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Vijay Pathak",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Vijay Pathak Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/image/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          Vijay Pathak
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/posts/">Writings</a>
            </li><li class="masthead__menu-item">
              <a href="/contact/">Contact</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero--overlay"
  style="background-color: #4f4d4d; background-image: url('');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          Air Pollution Visualization using Open Data

        
      </h1>
      
        <p class="page__lead">Visualize the air pollution in your community using JavaScript and open-data
</p>
      
      
        <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  6 minute read

</p>
      
      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/image/avatar-vijay.jpeg" alt="Vijay Pathak" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Vijay Pathak</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Hey there! lets go social</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:vijay@vijaypathak.com.np" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i> Email</a></li>
          
        
          
        
          
            <li><a href="https://twitter.com/hbvj99" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i> Twitter</a></li>
          
        
          
        
          
            <li><a href="https://github.com/hbvj99" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/hbvj99/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
          
        
          
            <li><a href="https://instagram.com/hbvj99" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Air Pollution Visualization using Open Data">
    <meta itemprop="description" content="Visualize the air pollution in your community using JavaScript and open-data">
    <meta itemprop="datePublished" content="2019-01-27T00:00:00+05:45">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#air-pollution">Air pollution?</a></li>
  <li><a href="#how-it-works">How it works?</a></li>
  <li><a href="#atmospheric-particulates-data-available">Atmospheric particulates data available</a></li>
  <li><a href="#requirements">Requirements</a></li>
  <li><a href="#how-it-works-1">How it works?</a>
    <ul>
      <li><a href="#xml-tree-structure">Xml tree structure</a></li>
    </ul>
  </li>
  <li><a href="#render-chart-in-html">Render Chart in HTML</a></li>
  <li><a href="#at-last">At last</a></li>
</ul>

            </nav>
          </aside>
        
        <p>This is a small project I did when I was in college, the use of open data to create effective air pollution awareness among the community using JQuery. View how the air quality is changing, health effect it offers using chart visualization provided by CanvasJS, save the visualization in image or PDF document.</p>

<h2 id="air-pollution">Air pollution?</h2>
<p>Emissions is the term used to describe the gases and particles which are suspended or emitted in the air through various sources which results in formation of toxics substances which includes carbon monoxide, nitrous oxides, methane, chlorofluorocarbons gases often harmful to human health when consumed indirectly at Hazardous levels - detrimental to human health and the planet, major factor for <a href="https://www.epa.gov/clean-air-act-overview/air-pollution-current-and-future-challenges#limiting">Climate Change</a>.</p>

<h2 id="how-it-works">How it works?</h2>
<ul>
  <li>Fetch open-source data available at <a href="https://www.epa.gov/outdoor-air-quality-data" target="_blank">EPA</a></li>
  <li>Render in charts using <a href="https://canvasjs.com/" target="_blank">CanvasJS</a></li>
  <li>Display health messages based on current air</li>
  <li>Visualize AQI, PM2.5 using AQI color code</li>
</ul>

<h2 id="atmospheric-particulates-data-available">Atmospheric particulates data available</h2>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/Air_quality_index" target="_blank">AQI</a></li>
  <li>PM2.5<a href="https://en.wikipedia.org/wiki/NowCast_(air_quality_index)" target="_blank"> NowCast </a>Concentration</li>
  <li><a href="https://en.wikipedia.org/wiki/Particulates">PM2.5</a></li>
</ul>

<h2 id="requirements">Requirements</h2>
<ul>
  <li>CanvasJS 2.0, get free license if you are a student <a href="https://canvasjs.com/apply/student/">here</a></li>
  <li>Query 3, get <a href="https://jquery.com/download/">here</a></li>
</ul>

<h2 id="how-it-works-1">How it works?</h2>
<p>Lets first create a simple CanvasJS, enable some of the useful features like animation, theme, interactive, tooltip, subtitles inside <code class="highlighter-rouge">chart_data</code></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">chart_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">animationEnabled</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">exportEnabled</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">exportFileName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Phora Durbar Live AQI</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">animationDuration</span><span class="p">:</span> <span class="mi">1400</span><span class="p">,</span>
    <span class="na">zoomEnabled</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">zoomType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">xy</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">theme</span><span class="p">:</span> <span class="dl">"</span><span class="s2">light1</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">interactivityEnabled</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>

    <span class="na">toolTip</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Date: {label}&lt;br/&gt;Data: {y}</span><span class="dl">"</span>
    <span class="p">},</span>

    <span class="na">axisY</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">AQI</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">valueFormatString</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">title</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">text</span><span class="p">:</span> <span class="dl">"</span><span class="s2">AQI</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">},</span>

    <span class="na">subtitles</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">text</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Phora Durbar, Kathmandu</span><span class="dl">"</span>
    <span class="p">}],</span>

<span class="p">}</span>
</code></pre></div></div>
<p>Next, we’ll define empty Array <code class="highlighter-rouge">dataPoints</code> in <code class="highlighter-rouge">chart_data</code></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">data</span><span class="p">:</span> <span class="p">[{</span>
     <span class="na">dataPoints</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}]</span>
</code></pre></div></div>

<p>We are creating a visualization for realtime emission - <a href="https://www.epa.gov/">EPA</a> has physical stations in the various cities to measure air pollution levels and also keep record for historical data. We’ll simply use the <a href="https://www.airnow.gov/index.cfm?action=airnow.global_summary">data</a> available globally, collect the RSS feed available for your city and add URL to object. <code class="highlighter-rouge">window.onload</code> function is used to render the data first whenever CanvasJS is loaded.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">phora_pm2</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://dosairnowdata.org/dos/RSS/PhoraDurbarKathmandu/PhoraDurbarKathmandu-PM2.5.xml</span><span class="dl">'</span><span class="p">;</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">chartRenderer</span><span class="p">(</span><span class="nx">phora_pm2</span><span class="p">,</span>
        <span class="nx">chart_data</span><span class="p">,</span> <span class="dl">'</span><span class="s1">column</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">AQI</span><span class="dl">'</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We also need an AQI references where people would be able to distinguish the air pollution levels. It is divided into different color ranges and health messages.</p>

<p>Function <code class="highlighter-rouge">aqiColor</code> returns color code where AQI is input, add <code class="highlighter-rouge">healthMessage</code> to generate health message for AQI value <code class="highlighter-rouge">y</code>. The value range, color code and health message all can be found in the AQI Basics <a href="https://airnow.gov/index.cfm?action=aqibasics.aqi">doc</a>.</p>

<p><b>Note: You can change the chart type column to supported <a href="https://www.chartjs.org/docs/latest/charts/">Charts</a> by modifying chart_data when window.onload is initiated.</b></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">aqiColor</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">#fff</span><span class="dl">"</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">#34e400</span><span class="dl">"</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">51</span> <span class="o">&amp;&amp;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">#fcff00</span><span class="dl">"</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">101</span> <span class="o">&amp;&amp;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">150</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">#f77e01</span><span class="dl">"</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">151</span> <span class="o">&amp;&amp;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">#f61802</span><span class="dl">"</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">201</span> <span class="o">&amp;&amp;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">300</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">#8f3f97</span><span class="dl">"</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">301</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">#7e0623</span><span class="dl">"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">healthMessage</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">&lt;div class='text-uppercase'&gt;Error!&lt;/div&gt;&lt;br/&gt;No data was received from the station</span><span class="dl">"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">&lt;div class='text-uppercase'&gt;Good&lt;/div&gt;&lt;br/&gt;The AQI value is between 0 and 50. Air quality is satisfactory and poses little or no health risk.</span><span class="dl">"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">51</span> <span class="o">&amp;&amp;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">&lt;div class='text-uppercase'&gt;Moderate&lt;/div&gt;&lt;br/&gt;The AQI is between 51 and 100. Air quality is acceptable; however, pollution in this range may pose a moderate health concern for a very small number of individuals. People who are unusually sensitive to ozone or particle pollution may experience respiratory symptoms.</span><span class="dl">"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">101</span> <span class="o">&amp;&amp;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">150</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">&lt;div class='text-uppercase'&gt;Unhealthy for Sensitive Groups&lt;/div&gt;&lt;br/&gt;When AQI values are between 101 and 150, members of sensitive groups may experience health effects, but the general public is unlikely to be affected.&lt;br&gt;&lt;b&gt;Ozone:&lt;/b&gt; People with lung disease, children, older adults, and people who are active outdoors are considered sensitive and therefore at greater risk.&lt;br&gt;&lt;b&gt;Particle pollution:&lt;/b&gt; People with heart or lung disease, older adults, and children are considered sensitive and therefore at greater risk.</span><span class="dl">"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">151</span> <span class="o">&amp;&amp;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">&lt;div class='text-uppercase'&gt;Unhealthy&lt;/div&gt;&lt;br/&gt;Everyone may begin to experience health effects when AQI values are between 151 and 200. Members of sensitive groups may experience more serious health effects.</span><span class="dl">"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">201</span> <span class="o">&amp;&amp;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">300</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">&lt;div class='text-uppercase'&gt;Very Unhealthy&lt;/div&gt;&lt;br/&gt;AQI values between 201 and 300 trigger a health alert, meaning everyone may experience more serious health effects.</span><span class="dl">"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">301</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">"</span><span class="s2">&lt;div class='text-uppercase'&gt;Hazardous&lt;/div&gt;&lt;br/&gt;&lt;b&gt;Health alert:&lt;/b&gt; AQI values over 300 trigger health warnings of emergency conditions. The entire population is even more likely to be affected by serious health effects.</span><span class="dl">"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Finally, add function <code class="highlighter-rouge">chartRenderer</code> and include empty Arrays for <code class="highlighter-rouge">dataPoints</code> <code class="highlighter-rouge">lables_</code>. We use JQuery to fetch <a href="https://dosairnowdata.org/dos/RSS/PhoraDurbarKathmandu/PhoraDurbarKathmandu-PM2.5.xml">XML</a> data using <code class="highlighter-rouge">chartRenderer</code> function.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">chartRenderer</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">chartData</span><span class="p">,</span> <span class="nx">chartType</span><span class="p">,</span> <span class="nx">airDataType</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">chart</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CanvasJS</span><span class="p">.</span><span class="nx">Chart</span><span class="p">(</span><span class="dl">"</span><span class="s2">chartContainer</span><span class="dl">"</span><span class="p">,</span> <span class="nx">chartData</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nx">dataPoints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="kd">let</span> <span class="nx">labels_</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nx">$</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="nx">data</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="dl">"</span><span class="s2">item</span><span class="dl">"</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">$dataPoint</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

            <span class="kd">let</span> <span class="nx">label</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">$dataPoint</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">"</span><span class="s2">ReadingDateTime</span><span class="dl">"</span><span class="p">).</span><span class="nx">text</span><span class="p">()).</span><span class="nx">toLocaleString</span><span class="p">(</span><span class="dl">'</span><span class="s1">en-US</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">month</span><span class="p">:</span> <span class="dl">'</span><span class="s1">short</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">day</span><span class="p">:</span> <span class="dl">'</span><span class="s1">numeric</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">hour</span><span class="p">:</span> <span class="dl">'</span><span class="s1">numeric</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">hour12</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="na">minute</span><span class="p">:</span> <span class="dl">'</span><span class="s1">numeric</span><span class="dl">'</span>
            <span class="p">});</span>
            <span class="kd">let</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">$dataPoint</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">airDataType</span><span class="p">).</span><span class="nx">text</span><span class="p">();</span>
            <span class="nx">dataPoints</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="na">label</span><span class="p">:</span> <span class="nx">label</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">y</span><span class="p">),</span> <span class="na">color</span><span class="p">:</span> <span class="nx">aqiColor</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">y</span><span class="p">))});</span>
            <span class="nx">labels_</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">label</span><span class="p">)</span>

        <span class="p">});</span>
        <span class="nx">chartData</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">chartType</span>
        <span class="nx">chartData</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">dataPoints</span> <span class="o">=</span> <span class="nx">dataPoints</span>

        <span class="kd">let</span> <span class="nx">health_aqi</span> <span class="o">=</span> <span class="nx">dataPoints</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="kd">let</span> <span class="nx">z</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">health_aqi</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">y</span><span class="p">)</span>

        <span class="kd">let</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">healthMessage</span><span class="p">(</span><span class="nx">z</span><span class="p">)</span>

        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">health_message</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">message</span>

        <span class="nx">chart</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
    <span class="p">});</span>
</code></pre></div></div>
<p>If you refer to XML <a href="#xml-tree-structure">structure</a>, we are interested in XML <code class="highlighter-rouge">item</code> element where reading date, AQI and description are found. In <code class="highlighter-rouge">dataPoints</code>, <code class="highlighter-rouge">label</code> represents the time sequence in Month-Day-Time in 24hr format, <code class="highlighter-rouge">y</code> is AQI value in float data type, <code class="highlighter-rouge">aqiColor</code> fetch color code for every AQI, each feed from station may consists of 24 hours of data and interval of 1 hour update time. Later, the slicing is done to get the latest feed and generate health messages. Use <code class="highlighter-rouge">chart.render()</code> to visualize the chart. And don’t forget to add document.getElementById() method for <code class="highlighter-rouge">health_message</code> to render in HTML document.</p>

<h3 id="xml-tree-structure">Xml tree structure</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span>
├── rss
    └── channel
        └── title
             └── item
                 └── title
                 └── description
                 └── param
                 └── conc
                 └── nowcastconc
                 └── aqi
                 └── desc
                 └── readingdatetime
</code></pre></div></div>

<h2 id="render-chart-in-html">Render Chart in HTML</h2>

<p>Import JQuery, CanvasJS, visualization_document.js in HTML head tag. CanvasJS only render a chart if you include id, height, and width. Likewise, we will use the append health messages.</p>

<p>To render CanvasJS;</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"chartContainer"</span> <span class="na">style=</span><span class="s">"height: 420px; width: 100%;"</span><span class="nt">&gt;&lt;/div&gt;</span>
</code></pre></div></div>

<p>To render health message;</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"health_message"</span> <span class="na">class=</span><span class="s">"card text-justify"</span> <span class="na">style=</span><span class="s">"padding: 30px;"</span><span class="nt">&gt;</span>Updating...<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>We have successfully created a visualization graph with a health message for any latest AQI data. We are also adding a simple HTML table as a reference to the AQI color range and code to understand air quality better.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;table&gt;</span>
    <span class="nt">&lt;thead&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th&gt;</span>Color<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>AQI Level<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/thead&gt;</span>
    <span class="nt">&lt;tbody&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">style=</span><span class="s">"background: #34e400;"</span><span class="nt">&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>0 - 50 Good<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">style=</span><span class="s">"background: #fcff00;"</span><span class="nt">&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>51 - 100 Moderate<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">style=</span><span class="s">"background: #f77e01;"</span><span class="nt">&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>101 - 150 Unhealthy for Sensitive Groups<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">style=</span><span class="s">"background: #f61802;"</span><span class="nt">&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>151 - 200 Unhealthy<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">style=</span><span class="s">"background: #8f3f97;"</span><span class="nt">&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>201 - 300 Very Unhealthy<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">style=</span><span class="s">"background: #7e0623;"</span><span class="nt">&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>301 - 500 Hazardous<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</code></pre></div></div>

<h2 id="at-last">At last</h2>

<p>The final visualization;</p>

<p><img src="/assets/image/2018/chart_visualization.png" alt="chart visualization" /></p>

<p>You can find the source code <a href="https://github.com/hbvj99/kathmandu-air">here</a> or view live <a href="https://vijaypathak.com.np/kathmandu-air">demo</a>.</p>

<p>If you got stuck somewhere, find project file structure tree below;</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>air_pollution
 |
 +-- index.html
 |    
 +-- js
 |  |  
 |  <span class="se">\-</span>- canvasjs.min.js
 |  <span class="se">\-</span>- live_visualize.js
 |  <span class="se">\-</span>- jquery.min.js.js   
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#air-pollution" class="page__taxonomy-item" rel="tag">Air Pollution</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#emission" class="page__taxonomy-item" rel="tag">Emission</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#javascript" class="page__taxonomy-item" rel="tag">JavaScript</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#jquery" class="page__taxonomy-item" rel="tag">JQuery</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#visualizaiton" class="page__taxonomy-item" rel="tag">Visualizaiton</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#guides" class="page__taxonomy-item" rel="tag">Guides</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-01-27T00:00:00+05:45">January 27, 2019</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Air+Pollution+Visualization+using+Open+Data%20http%3A%2F%2Flocalhost%3A4000%2F2019%2F01%2Fair-pollution-visualization-using-open-data.html" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2019%2F01%2Fair-pollution-visualization-using-open-data.html" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2F2019%2F01%2Fair-pollution-visualization-using-open-data.html" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="#" class="pagination--pager disabled">Previous</a>
    
    
      <a href="/2019/11/nettv-box-hack.html" class="pagination--pager" title="NetTv Box Easy Hack
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020/02/internet-explorer-detection-using-javascript.html" rel="permalink">Internet Explorer detection using javascript
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Guide on detecting IE browser and adding custom warning message
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2019/11/liquid-whitespaces-in-jekyll.html" rel="permalink">Liquid Whitespaces in Jekyll
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Guide on removing extra whitespaces in Jekyll
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2019/11/nettv-box-hack.html" rel="permalink">NetTv Box Easy Hack
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Install Android TV OS firmware in IPTV box works for Vianet, Worldink User.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons"><br><li><a href="https://twitter.com/hbvj99" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> </a></li><li><a href="mailto:vijay@vijaypathak.com.np" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> </a></li><li><a href="https://github.com/hbvj99" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> </a></li><li><a href="https://www.linkedin.com/in/hbvj99" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> </a></li><li><a href="https://instagram.com/hbvj99" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> </a></li><li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> </a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; Vijay Pathak 2020</div><br>
<div class="page__footer-copyright">Made with <i class="fas fa-heart"></i><a href="https://github.com/mmistakes/minimal-mistakes" rel="nofollow"> Minimal Mistakes</a></div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/2019/01/air-pollution-visualization-using-open-data.html";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/2019/01/air-pollution-visualization-using-open-data"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://vijaypathak.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
